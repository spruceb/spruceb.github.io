<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<title>Spruce's Emacs</title>
<!-- 2016-10-23 Sun 18:01 -->
<meta  http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta  name="generator" content="Org-mode" />
<meta  name="author" content="Spruce Bondera" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center; }
  .todo   { font-family: monospace; color: red; }
  .done   { color: green; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  pre.src-sh:before    { content: 'sh'; }
  pre.src-bash:before  { content: 'sh'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-R:before     { content: 'R'; }
  pre.src-perl:before  { content: 'Perl'; }
  pre.src-java:before  { content: 'Java'; }
  pre.src-sql:before   { content: 'SQL'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.right  { text-align: center;  }
  th.left   { text-align: center;   }
  th.center { text-align: center; }
  td.right  { text-align: right;  }
  td.left   { text-align: left;   }
  td.center { text-align: center; }
  dt { font-weight: bold; }
  .footpara:nth-child(2) { display: inline; }
  .footpara { display: block; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="/Users/spruce/.emacs.d/literate/css/org-export.css"></link>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">Spruce's Emacs</h1>
<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1">About</h2>
<div class="outline-text-2" id="text-1">
<p>
This file, and the others it references, contain my Emacs configuration. I've
been using Emacs since around 2014, and using it heavily since mid-2015. Over
the course of the next year and a half I accumulated a serious amount of config
and packages of various forms. Emacs is software with a hilariously high
potential ceiling (I haven't caught a glimpse of it yet), but in my view pretty
terrible defaults. A large part of my switch to fully using it was due to
accumulating the critical mass of configuration necessary to use it without
significant annoyance.
</p>

<p>
It's easy to just throw config in your <code>.emacs</code> or <code>init.el</code>, which is
what I did for over a year and a half. However at a certain point it accumulates
cruft, competing and contradictory code, becomes impossible to search through,
and even worse to debug. It's pretty common in the Emacs community to deal with
this through literate programming through <code>org-mode</code>. The code becomes somewhat
secondary to documentation and organization, making it easier to keep track of
and modify. This is my ongoing attempt to organize, clean up, and improve my
config. Started October 15th, 2016.
</p>
</div>
</div>
<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2">Contents&#xa0;&#xa0;&#xa0;<span class="tag"><span class="TOC_2_org">TOC_2_org</span></span></h2>
<div class="outline-text-2" id="text-2">
<ul class="org-ul">
<li><a href="#sec-1">About</a>
</li>
<li><a href="#sec-3">Bootstrap</a>
<ul class="org-ul">
<li><a href="#sec-3-1">Security</a>
</li>
<li><a href="#sec-3-2">Configuration Management</a>
</li>
<li><a href="#sec-3-3">Personal Information</a>
</li>
<li><a href="#sec-3-4">Utility Functions</a>
</li>
<li><a href="#sec-3-5">Default Settings</a>
</li>
<li><a href="#sec-3-6">Keybindings</a>
</li>
<li><a href="#sec-3-7">Basic Appearance</a>
</li>
<li><a href="#sec-3-8">macOS</a>
</li>
</ul>
</li>
<li><a href="#sec-4">General</a>
<ul class="org-ul">
<li><a href="#sec-4-1">Helm</a>
</li>
<li><a href="#sec-4-2">Navigation</a>
</li>
<li><a href="#sec-4-3">Appearance</a>
</li>
</ul>
</li>
<li><a href="#sec-5">Programming</a>
<ul class="org-ul">
<li><a href="#sec-4">General</a>
</li>
<li><a href="#sec-5-2">CC</a>
</li>
<li><a href="#sec-5-3">Python</a>
</li>
<li><a href="#sec-5-4">Emacs Lisp</a>
</li>
<li><a href="#sec-5-5">Coffeescript</a>
</li>
</ul>
</li>
<li><a href="#sec-6">Org</a>
</li>
<li><a href="#sec-7">LaTeX</a>
</li>
<li><a href="#sec-8">The Heap</a>
<ul class="org-ul">
<li><a href="#sec-8-1">Package Heap</a>
</li>
<li><a href="#sec-8-2">Old Heap</a>
</li>
</ul>
</li>
<li><a href="#sec-3-4">Utility Functions</a>
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3">Bootstrap</h2>
<div class="outline-text-2" id="text-3">
</div><div id="outline-container-sec-3-1" class="outline-3">
<h3 id="sec-3-1">Security</h3>
<div class="outline-text-3" id="text-3-1">
<p>
There are several important security improvements to Emacs that should come as
early a possible in config, to prevent inevitable network connection attempts
from being hilariously insecure
</p>
</div>
<div id="outline-container-sec-3-1-1" class="outline-4">
<h4 id="sec-3-1-1">TLS</h4>
<div class="outline-text-4" id="text-3-1-1">
<p>
Much of the following is credited to <a href="https://glyph.twistedmatrix.com/2015/11/editor-malware.html">Glyph</a>.
</p>

<p>
<code>network-security-level</code> sets how careful Emacs is with network security. The
default is <code>medium</code>, but I prefer <code>high</code>, as it prevents a few more problematic
practices. <code>paranoid</code> is a little far for me though.
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #51afef;">setq</span> network-security-level 'high)
</pre>
</div>

<p>
However this only matters in Emacs 25 and higher. For older versions, network
connections are not secure by default at all. This enables TLS checking.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #51afef;">setq</span> tls-checktrust t)
</pre>
</div>

<p>
All of the above only applies to Emacs not built with an external TLS checker.
However if it is built with one like GnuTLS, some extra config is necessary.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #51afef;">let</span> ((trustfile
       (replace-regexp-in-string
        <span style="color: #98be65;">"\\\\"</span> <span style="color: #98be65;">"/"</span>
        (replace-regexp-in-string
         <span style="color: #98be65;">"\n"</span> <span style="color: #98be65;">""</span>
         (shell-command-to-string <span style="color: #98be65;">"python -m certifi"</span>)))))
  (<span style="color: #51afef;">setq</span> tls-program
        (list
         (format <span style="color: #98be65;">"gnutls-cli%s --x509cafile %s -p %%p %%h"</span>
                 (<span style="color: #51afef;">if</span> (eq window-system 'w32) <span style="color: #98be65;">".exe"</span> <span style="color: #98be65;">""</span>) trustfile)))
  (<span style="color: #51afef;">setq</span> gnutls-verify-error t)
  (<span style="color: #51afef;">setq</span> gnutls-trustfiles (list trustfile)))
</pre>
</div>

<p>
This ensures that TLS is configured correctly, and prevents further config
evaluation otherwise. Currently disabled for speed.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #51afef;">let</span> ((bad-hosts
       (<span style="color: #51afef;">loop</span> for bad
             in `(<span style="color: #98be65;">"https://wrong.host.badssl.com/"</span>
                  <span style="color: #98be65;">"https://self-signed.badssl.com/"</span>)
             if (<span style="color: #51afef;">condition-case</span> e
                    (url-retrieve
                     bad (<span style="color: #51afef;">lambda</span> (retrieved) t))
                  (<span style="color: #ECBE7B;">error</span> nil))
             collect bad)))
  (<span style="color: #51afef;">if</span> bad-hosts
      (<span style="color: #ECBE7B;">error</span> (format <span style="color: #98be65;">"tls misconfigured; retrieved %s ok"</span>
                     bad-hosts))
    (url-retrieve <span style="color: #98be65;">"https://badssl.com"</span>
                  (<span style="color: #51afef;">lambda</span> (retrieved) t))))
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-3-2" class="outline-3">
<h3 id="sec-3-2">Configuration Management</h3>
<div class="outline-text-3" id="text-3-2">
</div><div id="outline-container-sec-3-2-1" class="outline-4">
<h4 id="sec-3-2-1"><code>use-package</code></h4>
<div class="outline-text-4" id="text-3-2-1">
<p>
I use the <code>use-package</code> package <a href="https://github.com/jwiegley/use-package">(here)</a> to configure both Emacs and the large
number of other packages I use.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #51afef;">unless</span> (package-installed-p 'use-package)
  (package-refresh-contents)
  (package-install 'use-package))
(<span style="color: #51afef;">require</span> '<span style="color: #a9a1e1;">use-package</span>)
<span style="color: #5B6268;">;; </span><span style="color: #5B6268;">All packages in a use-package macro should be automatically installed</span>
(<span style="color: #51afef;">setq</span> use-package-always-ensure t)
</pre>
</div>
<p>
Additionally, I use the <code>:diminish</code> feature of <code>use-package</code> to hide various minor
modes from my mode line.
</p>
</div>
</div>
<div id="outline-container-sec-3-2-2" class="outline-4">
<h4 id="sec-3-2-2"><span class="todo TODO">TODO</span> <code>validate</code></h4>
<div class="outline-text-4" id="text-3-2-2">
<p>
<code>validate</code> is a package that tries to minimize invalid variable values. Emacs and
many packages have user-configurable variables that should only hold certain
values, perhaps only integers or only one of a list of symbols. It's possible to
subtly mis-configure these, potentially letting Emacs to continue to run until
some feature is called and behaves wildly unexpectedly. So I use <code>validate</code> and
<code>validate-setq</code> whenever possible.
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #51afef;">use-package</span> <span style="color: #a9a1e1;">validate</span>)
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-3-2-3" class="outline-4">
<h4 id="sec-3-2-3">External Files</h4>
<div class="outline-text-4" id="text-3-2-3">
<p>
I have several external config files loaded by this one. These are given
variable names and added to a global list in various sections in this file. To
do this I use the following macro and list:
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #51afef;">setq-default</span> spruce/org-config-directory <span style="color: #98be65;">"literate"</span>)
(<span style="color: #51afef;">setq-default</span> spruce/org-config-dirpath
              (expand-file-name (concat user-emacs-directory
                                        spruce/org-config-directory)))
(add-to-list 'load-path spruce/org-config-dirpath)
(<span style="color: #51afef;">setq-default</span> spruce/config-org-files nil)

<span style="color: #5B6268;">;; </span><span style="color: #5B6268;">transforms the given name to "spruce/name-config-file" and sets it</span>
<span style="color: #5B6268;">;; </span><span style="color: #5B6268;">to the given org filename</span>
(<span style="color: #51afef;">defmacro</span> <span style="color: #c678dd;">spruce/new-config-file</span> (name filename)
  (<span style="color: #51afef;">let</span> ((full-file (make-symbol <span style="color: #98be65;">"full-filename"</span>)))
    `(<span style="color: #51afef;">let</span> ((,full-file
            (concat spruce/org-config-dirpath <span style="color: #98be65;">"/"</span> ,filename <span style="color: #98be65;">".org"</span>)))
       (<span style="color: #51afef;">defvar</span> ,(intern (concat <span style="color: #98be65;">"spruce/"</span> (symbol-name name) <span style="color: #98be65;">"-config-file"</span>))
         ,full-file)
       (add-to-list
        (<span style="color: #51afef;">quote</span> spruce/config-org-files) (<span style="color: #51afef;">quote</span> (,name . ,filename)) t))))
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-3-2-4" class="outline-4">
<h4 id="sec-3-2-4"><code>customize</code></h4>
<div class="outline-text-4" id="text-3-2-4">
<p>
Emacs has a built-in customization interface which auto-inserts code into your
init file. This is useful for many people and makes it pretty easy to discover
and configure settings, but I generally don't use it anymore and dislike the
undocumented format. However sometimes these settings still crop up, so I dump
them in a file and eventually configure them correctly. 
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #51afef;">setq</span> custom-file (concat spruce/org-config-dirpath <span style="color: #98be65;">"/temp-custom.el"</span>))
(load-file custom-file)
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-3-2-5" class="outline-4">
<h4 id="sec-3-2-5">Table of Contents</h4>
<div class="outline-text-4" id="text-3-2-5">
<p>
While <code>org</code> exports nice tables of contents by default, they don't appear directly
in org files, and GitHub doesn't render them. So I use a package that (somewhat
worryingly) automatically inserts a table of contents into the actual org file.
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #51afef;">use-package</span> <span style="color: #a9a1e1;">toc-org</span>
  <span style="color: #c678dd;">:config</span>
  (add-hook 'org-mode-hook 'toc-org-enable))
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-3-3" class="outline-3">
<h3 id="sec-3-3">Personal Information</h3>
<div class="outline-text-3" id="text-3-3">
<p>
My name and primary email for use in various other places.
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #51afef;">setq</span> user-full-name <span style="color: #98be65;">"Spruce Bondera"</span>
      user-mail-address <span style="color: #98be65;">"sprucebondera@gmail.com"</span>)
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-3-4" class="outline-3">
<h3 id="sec-3-4">Utility Functions</h3>
<div class="outline-text-3" id="text-3-4">
<p>
I have a number of functions not particularly tied to a specific mode or
feature-set. Many of them were defined exclusively to be accessible through a
keybinding, however if I deem them sufficiently general they get put in the
Utility Functions section, and included up here. These functions are in fact
defined at the bottom of this file, but are accessible to all config below this point.
</p>
</div>
</div>
<div id="outline-container-sec-3-5" class="outline-3">
<h3 id="sec-3-5">Default Settings</h3>
<div class="outline-text-3" id="text-3-5">
</div><div id="outline-container-sec-3-5-1" class="outline-4">
<h4 id="sec-3-5-1">Modernization</h4>
<div class="outline-text-4" id="text-3-5-1">
<p>
Emacs is very old, and has a number of defaults that reflect this age. Some of
these I like, many I don't. 
</p>

<p>
It's normal text editing behavior to automatically replace selected text if a new
character is typed.
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp">(delete-selection-mode t)
</pre>
</div>

<p>
In Fundamental mode, use a single spaces after sentence-ending periods. Double
spaces are from the typewriter period and should not be used in modern documents.
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #51afef;">setq</span> sentence-end-double-space nil)
</pre>
</div>
<p>
Emacs is user-level software, not a shell, so some protection is nice. Using
a Trash is one such protection I occasionally still appreciate.
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #51afef;">setq</span> delete-by-moving-to-trash t)
</pre>
</div>
<p>
Like some terminal emulators, graphical Emacs clients resize "line/column"-wise
by default (i.e. snapping to the nearest line or column). In theory this could
be useful, but it's wildly unexpected and odd looking in modern systems. This
setting tries to make "frames" (Emacs' term for windows) resize normally.
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #51afef;">setq</span> frame-resize-pixelwise t)
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-3-5-2" class="outline-4">
<h4 id="sec-3-5-2">Parentheses Highlighting</h4>
<div class="outline-text-4" id="text-3-5-2">
<p>
Highlight corresponding parentheses if the cursor is over one of them. This is
pretty important in most languages, especially with the S-expression
manipulations I often perform.
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #51afef;">setq</span> show-paren-delay 0)
(show-paren-mode t)
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-3-5-3" class="outline-4">
<h4 id="sec-3-5-3">Scratch buffer</h4>
<div class="outline-text-4" id="text-3-5-3">
<p>
I prefer a blank scratch buffer. The default message is just going to be deleted
anyway. In the future I may set some more complicated and useful programmatic
message as the default, but for the moment an empty buffer is the most useful
option.
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #51afef;">setq</span> initial-scratch-message <span style="color: #98be65;">""</span>)
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-3-5-4" class="outline-4">
<h4 id="sec-3-5-4">Backups</h4>
<div class="outline-text-4" id="text-3-5-4">
<p>
I have plenty of disk space, so as many backups as possible is great. However I
definitely don't want them cluttering up random directories.
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #51afef;">setq</span> backup-directory-alist '((<span style="color: #98be65;">"."</span> . <span style="color: #98be65;">"~/.emacs.d/backup"</span>))
      backup-by-copying t    <span style="color: #5B6268;">; </span><span style="color: #5B6268;">Don't delink hardlinks</span>
      version-control t      <span style="color: #5B6268;">; </span><span style="color: #5B6268;">Use version numbers on backups</span>
      delete-old-versions 'never)
</pre>
</div>

<p>
Additionally I want to autosave early and often, but not cause clutter.
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #51afef;">setq</span> auto-save-file-name-transforms
      `((<span style="color: #98be65;">".*"</span> <span style="color: #98be65;">"/Users/spruce/.emacs.d/autosaves"</span> t)))
(<span style="color: #51afef;">setq</span> auto-save-interval 100) <span style="color: #5B6268;">; </span><span style="color: #5B6268;">100 characters</span>
(<span style="color: #51afef;">setq</span> auto-save-timeout 10)   <span style="color: #5B6268;">; </span><span style="color: #5B6268;">or 10 seconds</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-3-5-5" class="outline-4">
<h4 id="sec-3-5-5"><code>kill-line</code></h4>
<div class="outline-text-4" id="text-3-5-5">
<p>
By default <code>C-k</code> or <code>kill-line</code> doesn't truly delete the line, but rather kill
all the text on it while leaving the newline. There are situations where this is
useful, but overall I prefer deletion of the entire line.
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #51afef;">setq</span> kill-whole-line t)
</pre>
</div>
<p>
I also appreciate having the ability to kill backwards easily.
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #51afef;">bind-key</span> <span style="color: #98be65;">"H-&lt;backspace&gt;"</span> 'backward-kill-line)
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-3-5-6" class="outline-4">
<h4 id="sec-3-5-6">Garbage Collection Performance</h4>
<div class="outline-text-4" id="text-3-5-6">
<p>
The default garbage collection of Emacs is quite aggressive. It collects garbage
after around 800KB of allocation. This is tiny for modern systems. However even
though I usually have &gt;= 16GB of RAM, setting the garbage collection threshold
too high leads to occasional but very noticeable pauses as large swaths of
memory are reclaimed. I think 100MB is a pretty reasonable balance, but I may
tweak this in the future.
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #51afef;">setq</span> gc-cons-threshold 100000000)
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-3-5-7" class="outline-4">
<h4 id="sec-3-5-7"><code>fill-column</code></h4>
<div class="outline-text-4" id="text-3-5-7">
<p>
I generally like to fill (i.e. redistribute line breaks to not go past a certain
point) my text and code, to make it easier to browse in various situations and
edit in multiple frames. I tend towards 80 characters in free text, and a loose
80 in code (some lines are much less readable if broken up purely for consistency).
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #51afef;">setq-default</span> fill-column 80)
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-3-5-8" class="outline-4">
<h4 id="sec-3-5-8">Scrolling Context Jumps</h4>
<div class="outline-text-4" id="text-3-5-8">
<p>
When paging down I tend to lose track of what I was reading unless some of the
previous page remains. A full half-screen is a little much, but around 4 lines
is usually enough for me to keep my bearings.
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #51afef;">setq</span> next-screen-context-lines 5)
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-3-5-9" class="outline-4">
<h4 id="sec-3-5-9">Mark Ring</h4>
<div class="outline-text-4" id="text-3-5-9">
<p>
The mark ring contains information about where marks (selection points) were
set. Since I have a modern computer I see no reason for this to be small.
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #51afef;">setq</span> global-mark-ring-max 200)
(<span style="color: #51afef;">setq</span> mark-ring-max 100)
</pre>
</div>
<p>
Also, I like to be able to pop repeatedly more easily.
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #51afef;">setq</span> set-mark-command-repeat-pop t)
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-3-5-10" class="outline-4">
<h4 id="sec-3-5-10">Unicode</h4>
<div class="outline-text-4" id="text-3-5-10">
<p>
UTF-8 is pretty much the standard everywhere now. Better yet, unless I
specifically add "special" (non-ASCII) characters to a buffer, UTF-8 is
identical to ASCII, which is nice for compatibility with older programs.
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp">(prefer-coding-system 'utf-8)
(set-default-coding-systems 'utf-8)
(set-terminal-coding-system 'utf-8)<span style="background-color: #3D3D48;"> </span>
(set-keyboard-coding-system 'utf-8)
(<span style="color: #51afef;">setq</span> default-buffer-file-coding-system 'utf-8)
</pre>
</div>
</div>

<div id="outline-container-sec-3-5-10-1" class="outline-5">
<h5 id="sec-3-5-10-1"><span class="todo TODO">TODO</span> Double check the <code>set-terminal-coding-system</code> portability</h5>
</div>
</div>

<div id="outline-container-sec-3-5-11" class="outline-4">
<h4 id="sec-3-5-11">Enabling "dangerous" commands</h4>
<div class="outline-text-4" id="text-3-5-11">
<p>
There's a number of commands that Emacs considers potentially destructive or
dangerous for new users. I honestly think that in general this is a good
feature, but it can be annoying at times. Here I enable several of these
dangerous functions that I both understand and use.
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp">(put 'downcase-region 'disabled nil)
(put 'upcase-region 'disabled nil)
</pre>
</div>

<p>
In the same vein, when editing a symlinked and version controlled file (i.e.
opening a symlink to a file in version control) by default Emacs double checks
that this is in fact what you want to do, since various issues can arise if you
don't follow the link. I don't have any situations where I don't want to follow
said links, and it's less nagging.
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #51afef;">setq</span> vc-follow-symlinks t)
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-3-6" class="outline-3">
<h3 id="sec-3-6">Keybindings</h3>
<div class="outline-text-3" id="text-3-6">
</div><div id="outline-container-sec-3-6-1" class="outline-4">
<h4 id="sec-3-6-1">Config File Access</h4>
<div class="outline-text-4" id="text-3-6-1">
<p>
Quickly getting to my config file is important for fluid customization. Just as
programming and discovery is faster with a REPL. Emacs is really just one large
REPL, so I make it easier to use as such.
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #51afef;">defun</span> <span style="color: #c678dd;">spruce/open-config-file</span> ()
  (<span style="color: #51afef;">interactive</span>)
  (find-file (<span style="color: #51afef;">or</span> spruce/bootstrap-org-path
                 user-init-file <span style="color: #98be65;">""</span>)))
(<span style="color: #51afef;">bind-key</span> <span style="color: #98be65;">"C-c e"</span> 'spruce/open-config-file)
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-3-6-2" class="outline-4">
<h4 id="sec-3-6-2">Quick Fullscreen Mode</h4>
<div class="outline-text-4" id="text-3-6-2">
<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #51afef;">bind-key</span> <span style="color: #98be65;">"H-&lt;return&gt;"</span> 'toggle-frame-fullscreen)
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-3-6-3" class="outline-4">
<h4 id="sec-3-6-3">Line Shifting</h4>
<div class="outline-text-4" id="text-3-6-3">
<p>
Occasionally I like to shift whole lines up and down through a buffer. These
make it easier and more natural than killing and yanking.
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #51afef;">bind-keys</span> (<span style="color: #98be65;">"M-S-&lt;up&gt;"</span> . move-line-up)
           (<span style="color: #98be65;">"M-S-&lt;down&gt;"</span> . move-line-down))
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-3-6-4" class="outline-4">
<h4 id="sec-3-6-4">Buffer Reversion</h4>
<div class="outline-text-4" id="text-3-6-4">
<p>
I find myself needing to revert buffers weirdly often. I now try to solve this
with <code>auto-revert-mode</code> as much as possible, but this is still helpful.
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #51afef;">bind-key</span> <span style="color: #98be65;">"H-r"</span> 'revert-buffer-no-prompt)
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-3-6-5" class="outline-4">
<h4 id="sec-3-6-5">Macro Recording</h4>
<div class="outline-text-4" id="text-3-6-5">
<p>
It took me a while to understand and get used to the idea of keyboard macros.
Especially since they interact oddly with packages such as Helm. However once I
did start using them I found defining a slightly more memorable syntax helpful.
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #51afef;">bind-keys</span> (<span style="color: #98be65;">"M-["</span> . kmacro-start-macro)
           (<span style="color: #98be65;">"M-]"</span> . kmacro-end-macro))
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-3-7" class="outline-3">
<h3 id="sec-3-7">Basic Appearance</h3>
<div class="outline-text-3" id="text-3-7">
<p>
These are simple changes to the default settings.
</p>
</div>

<div id="outline-container-sec-3-7-1" class="outline-4">
<h4 id="sec-3-7-1">Useless Information</h4>
<div class="outline-text-4" id="text-3-7-1">
<p>
The tool bar is both useless and ugly. Same for the scroll bar. Disable both.
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp">(tool-bar-mode -1)
(scroll-bar-mode -1)
</pre>
</div>

<p>
Additionally, I dislike the startup message. The logo is ancient, and after
seeing it a few times the message is irrelevant. I use <code>desktop-mode</code>, but in the
situations where I do start from scratch, I prefer to start in <code>*scratch*</code>.
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #51afef;">setq</span> inhibit-startup-message t)
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-3-7-2" class="outline-4">
<h4 id="sec-3-7-2">Cursor</h4>
<div class="outline-text-4" id="text-3-7-2">
<p>
Somewhat similar to modern editors, I prefer a 1-pixel wide bar
cursor. However having a distinctive shape in non-active buffers
(rather than simply not blinking as in many other programs) is also quite useful.
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #51afef;">setq-default</span> cursor-type '(bar . 1))
(<span style="color: #51afef;">setq-default</span> cursor-in-non-selected-windows 'hollow)
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-3-7-3" class="outline-4">
<h4 id="sec-3-7-3">Frame Titles</h4>
<div class="outline-text-4" id="text-3-7-3">
<p>
Window titles include a lot of unnecessary information by default. I generally
find 3 things important: the buffer name, its mode, and whether it's been saved.
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #51afef;">setq</span> frame-title-format '(<span style="color: #98be65;">""</span> <span style="color: #98be65;">"%b %* [%m]"</span>))
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-3-7-4" class="outline-4">
<h4 id="sec-3-7-4">Fringe Wrap Indicators</h4>
<div class="outline-text-4" id="text-3-7-4">
<p>
The default fringe overage symbols are extremely ugly arrows. Unfortunately,
there is no way to use high resolution images for these. They literally must be
8x8 bitmaps, which explains why they're so ugly in the first place. However this
sequence of pseudo-dots looks a good bit better in my eyes.
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp">(define-fringe-bitmap 'right-curly-arrow
  [#b00000000
   #b00000000
   #b00000000
   #b00000000
   #b01010100
   #b01010100
   #b01010100
   #b00000000])

(define-fringe-bitmap 'left-curly-arrow
  [#b00000000
   #b00000000
   #b00000000
   #b00000000
   #b01010100
   #b01010100
   #b01010100
   #b00000000])
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-3-7-5" class="outline-4">
<h4 id="sec-3-7-5">Font Lock</h4>
<div class="outline-text-4" id="text-3-7-5">
<p>
I want syntax highlighting everywhere, and as much as possible.
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #51afef;">setq</span> font-lock-maximum-decoration t)
(global-font-lock-mode t)
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-3-7-6" class="outline-4">
<h4 id="sec-3-7-6">Prettify Symbols</h4>
<div class="outline-text-4" id="text-3-7-6">
<p>
Similarly, I like to have nice many text representations of symbols replaced
with those symbols. i.e. in <code>emacs-lisp</code> mode I see "lambda" as λ. This is
especially useful for LaTeX editing. However I also like to edit the real
underlying text easily, so I set the symbols to revert whenever the cursor is
touching.
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp">(global-prettify-symbols-mode)
(<span style="color: #51afef;">setq</span> prettify-symbols-unprettify-at-point 'right-edge)
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-3-8" class="outline-3">
<h3 id="sec-3-8">macOS</h3>
<div class="outline-text-3" id="text-3-8">
<p>
I run <a href="https://bitbucket.org/mituharu/emacs-mac/overview">Mitsuharu Yamamoto's</a> <code>emacs-macport</code> on the latest
version of macOS. There are several configuration options specific to
this platform that I use.
</p>

<p>
These settings are kept in a separate file for clean tangling
conditional on the operating system.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #51afef;">spruce/new-config-file</span> macOS <span style="color: #98be65;">"macOS"</span>)
(<span style="color: #51afef;">when</span> (eq system-type 'darwin)
  (org-babel-load-file spruce/macOS-config-file))
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-4" class="outline-2">
<h2 id="sec-4">General</h2>
<div class="outline-text-2" id="text-4">
</div><div id="outline-container-sec-4-1" class="outline-3">
<h3 id="sec-4-1"><span class="todo TODO">TODO</span> Helm</h3>
<div class="outline-text-3" id="text-4-1">
<p>
Helm is probably the most important package I use. At its core, it's just an
alternative selection system. Selection is an extremely common activity in
Emacs, selecting a file, using M-x to select a command, selecting a buffer to
switch to, etc. Helm provides a consistent, sane, and incredibly convenient
framework for selection, including the best search method I have ever seen. My
only complaint about it is going back to other applications where selecting
commands or finding files takes actual mental effort. 
</p>

<p>
Helm can plug into and replace a large number of Emacs features, as well as many
other packages. I generally put such configs in the other packages, as I now
view Helm as more part of my default Emacs rather than a separate package. For
default Emacs features, a large part of this "plugging in" is just rebinding
default keybindings to Helm versions of Emacs commands.    
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #51afef;">use-package</span> <span style="color: #a9a1e1;">helm</span>
  <span style="color: #c678dd;">:diminish</span> helm-mode
  <span style="color: #c678dd;">:init</span> (<span style="color: #51afef;">require</span> '<span style="color: #a9a1e1;">helm-config</span>)
  <span style="color: #c678dd;">:config</span>
  <span style="color: #5B6268;">;; </span><span style="color: #5B6268;">Fuzzy matching makes my typos less important and also doesn't get in my way</span>
  <span style="color: #5B6268;">;; </span><span style="color: #5B6268;">when I know exactly what I want</span>
  (<span style="color: #51afef;">setq</span> helm-M-x-fuzzy-match t)
  (<span style="color: #51afef;">setq</span> helm-mode-fuzzy-match t)

  <span style="color: #5B6268;">;; </span><span style="color: #5B6268;">Default Helm can open buffers in weird and disorienting positions. I prefer</span>
  <span style="color: #5B6268;">;; </span><span style="color: #5B6268;">it always attempting to pop up as if from the mode line.</span>
  (<span style="color: #51afef;">setq</span> helm-split-window-in-side-p t)

  <span style="color: #5B6268;">;; </span><span style="color: #5B6268;">Enable Helm globally</span>
  (helm-mode t)
</pre>
</div>

<p>
Move to company/projectile configs
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #51afef;">with-eval-after-load</span> 'company
  (<span style="color: #51afef;">bind-key</span> <span style="color: #98be65;">"C-:"</span> 'helm-company company-mode-map)
  (<span style="color: #51afef;">bind-key</span> <span style="color: #98be65;">"C-:"</span> 'helm-company company-active-map))
(<span style="color: #51afef;">with-eval-after-load</span> 'projectile
  (<span style="color: #51afef;">setq</span> projectile-completion-system 'helm))
</pre>
</div>
<p>
While Helm replaces several default Emacs functions to make many commands behave
better, it also has specialized versions with extra features. I replace as many
default options as possible.
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #c678dd;">:bind</span> ((<span style="color: #98be65;">"M-x"</span> . helm-M-x)
       (<span style="color: #98be65;">"C-x C-f"</span> . helm-find-files)
       (<span style="color: #98be65;">"C-x b"</span> . helm-mini)
       (<span style="color: #98be65;">"C-x C-b"</span> . helm-buffers-list)
       (<span style="color: #98be65;">"C-c h o"</span> . helm-occur)
       (<span style="color: #98be65;">"M-s o"</span> . helm-occur)
       <span style="color: #c678dd;">:map</span> helm-map
       <span style="color: #5B6268;">;; </span><span style="color: #5B6268;">In Helm a persistent action is something that can be done in a Helm</span>
       <span style="color: #5B6268;">;; </span><span style="color: #5B6268;">buffer without ending the session. By default it's bound to C-z, and</span>
       <span style="color: #5B6268;">;; </span><span style="color: #5B6268;">tab is bound to selection of a non-persistent action. I prefer swapping</span>
       <span style="color: #5B6268;">;; </span><span style="color: #5B6268;">C-z and tab functionality.</span>
       (<span style="color: #98be65;">"&lt;tab&gt;"</span> . helm-execute-persistent-action)
       (<span style="color: #98be65;">"C-i"</span> . helm-execute-persistent-action) <span style="color: #5B6268;">; </span><span style="color: #5B6268;">for use in terminal</span>
       (<span style="color: #98be65;">"C-z"</span> . helm-select-action)))
</pre>
</div>

<p>
<code>flx</code> is a package that allows for Sublime-like great fuzzy matching. <code>helm-flx</code>
plugs in this functionality to Helm's fuzzy matching.
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #51afef;">use-package</span> <span style="color: #a9a1e1;">helm-flx</span>
  <span style="color: #c678dd;">:config</span> (helm-flx-mode t))
</pre>
</div>

<p>
Projectile is another incredibly important package for me, and of course I'd
like to use Helm for all of its various features.
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #51afef;">use-package</span> <span style="color: #a9a1e1;">helm-projectile</span>
  <span style="color: #c678dd;">:config</span>
  (<span style="color: #51afef;">with-eval-after-load</span> 'projectile
    (helm-projectile-on)))
</pre>
</div>

<p>
<code>helm-swoop</code> is a replacement for <code>isearch</code> and <code>occur</code> that searches buffers with a
Helm-based interface and automatically moves through the searched buffer and
highlights the matches. It also allows for editing the searches in a separate
buffer and saving them back.
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #51afef;">use-package</span> <span style="color: #a9a1e1;">helm-swoop</span>
  <span style="color: #c678dd;">:config</span>
  <span style="color: #5B6268;">;; </span><span style="color: #5B6268;">Do the same window split as with the rest of Helm, i.e. inside the current</span>
  <span style="color: #5B6268;">;; </span><span style="color: #5B6268;">buffer and vertically if possible</span>
  (<span style="color: #51afef;">setq</span> helm-swoop-split-with-multiple-windows t)
  (<span style="color: #51afef;">setq</span> helm-swoop-split-direction 'split-window-vertically)
  <span style="color: #5B6268;">;; </span><span style="color: #5B6268;">Keep the font lock (color/highlighting etc) from the searched buffer in the</span>
  <span style="color: #5B6268;">;; </span><span style="color: #5B6268;">results. This slows down the search, but not very perceptibly.</span>
  (<span style="color: #51afef;">setq</span> helm-swoop-speed-or-color t)
  <span style="color: #c678dd;">:bind</span> ((<span style="color: #98be65;">"C-c s"</span> . isearch-forward)
         <span style="color: #5B6268;">;; </span><span style="color: #5B6268;">I replace the default isearch binding with swoop. I also tend to</span>
         <span style="color: #5B6268;">;; </span><span style="color: #5B6268;">type new searches more often than I use the symbol at the point, so</span>
         <span style="color: #5B6268;">;; </span><span style="color: #5B6268;">I use the no-pre-input version.</span>
         (<span style="color: #98be65;">"C-s"</span> . helm-swoop-without-pre-input)
         <span style="color: #5B6268;">;; </span><span style="color: #5B6268;">But I can take input as by default, if necessary.</span>
         (<span style="color: #98be65;">"C-M-s"</span> . helm-swoop)
         <span style="color: #c678dd;">:map</span> helm-swoop-map
         <span style="color: #5B6268;">;; </span><span style="color: #5B6268;">Switch to multi-swoop from swoop</span>
         (<span style="color: #98be65;">"M-i"</span> . helm-multi-swoop-all-from-helm-swoop)))
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-4-2" class="outline-3">
<h3 id="sec-4-2">Navigation</h3>
</div>
<div id="outline-container-sec-4-3" class="outline-3">
<h3 id="sec-4-3">Appearance</h3>
<div class="outline-text-3" id="text-4-3">
</div><div id="outline-container-sec-4-3-1" class="outline-4">
<h4 id="sec-4-3-1">Mode Line</h4>
<div class="outline-text-4" id="text-4-3-1">
<p>
The column number is often useful for me, enough to be in the mode line.
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp">(column-number-mode t)
</pre>
</div>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #51afef;">require</span> '<span style="color: #a9a1e1;">smart-mode-line</span>)
(<span style="color: #51afef;">setq</span> sml/theme 'respectful)
(<span style="color: #51afef;">setq</span> sml/shorten-directory t)
(<span style="color: #51afef;">setq</span> sml/shorten-modes t)
(<span style="color: #51afef;">use-package</span> <span style="color: #a9a1e1;">autorevert</span>
  <span style="color: #c678dd;">:diminish</span> auto-revert-mode)
(<span style="color: #51afef;">setq</span> sml/replacer-regexp-list nil)
(<span style="color: #51afef;">setq</span> sml/no-confirm-load-theme t)
(<span style="color: #51afef;">setq</span> sml/line-number-format <span style="color: #98be65;">"  %3l "</span>)
(sml/setup)
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-4-3-2" class="outline-4">
<h4 id="sec-4-3-2">Appearance Heap</h4>
<div class="outline-text-4" id="text-4-3-2">
<div class="org-src-container">

<pre class="src src-emacs-lisp">(set-face-attribute 'default nil <span style="color: #c678dd;">:font</span> <span style="color: #98be65;">"Source Code Pro-12"</span>)
<span style="color: #5B6268;">;; </span><span style="color: #5B6268;">(when (and (string-match "Carbon" (emacs-version)) (window-system))</span>
<span style="color: #5B6268;">;;   </span><span style="color: #5B6268;">(load-theme 'spacegray-spruce t))</span>

(set-frame-font <span style="color: #98be65;">"Source Code Pro-12"</span>)
(<span style="color: #51afef;">use-package</span> <span style="color: #a9a1e1;">all-the-icons</span>)
(<span style="color: #51afef;">use-package</span> <span style="color: #a9a1e1;">neotree</span>)
(<span style="color: #51afef;">use-package</span> <span style="color: #a9a1e1;">doom-themes</span>
  <span style="color: #c678dd;">:diminish</span> doom-buffer-mode
  <span style="color: #c678dd;">:after</span> neotree
  <span style="color: #c678dd;">:config</span>
  (<span style="color: #51afef;">setq</span> doom-neotree-file-icons t)
  (add-hook 'find-file-hook 'doom-buffer-mode)
  <span style="color: #5B6268;">;; </span><span style="color: #5B6268;">brighter minibuffer when active</span>
  (add-hook 'minibuffer-setup-hook 'doom-brighten-minibuffer)
  (load-theme 'doom-one t)
  (<span style="color: #51afef;">require</span> '<span style="color: #a9a1e1;">doom-neotree</span>))
(<span style="color: #51afef;">when</span> (boundp 'window-divider-mode)
  (<span style="color: #51afef;">setq</span> window-divider-default-places t
        window-divider-default-bottom-width 1
        window-divider-default-right-width 1)
  (window-divider-mode +1))
</pre>
</div>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-5" class="outline-2">
<h2 id="sec-5">Programming</h2>
<div class="outline-text-2" id="text-5">
</div><div id="outline-container-sec-5-1" class="outline-3">
<h3 id="sec-5-1">General</h3>
<div class="outline-text-3" id="text-5-1">
</div><div id="outline-container-sec-5-1-1" class="outline-4">
<h4 id="sec-5-1-1">Spacing and Indentation</h4>
<div class="outline-text-4" id="text-5-1-1">
<div class="org-src-container">

<pre class="src src-emacs-lisp">(add-hook 'prog-mode-hook (<span style="color: #51afef;">lambda</span> () (<span style="color: #51afef;">setq</span> line-spacing nil)))
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-5-1-2" class="outline-4">
<h4 id="sec-5-1-2"><span class="todo TODO">TODO</span> Commenting</h4>
<div class="outline-text-4" id="text-5-1-2">
<p>
This function and keybinding basically do exactly what I want for commenting.
Apparently there's some shiny new options in Emacs 25 that I should probably
replace this with. Credit: <a href="https://lists.gnu.org/archive/html/emacs-devel/2008-12/msg00390.html">Will Farrington</a>.
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #51afef;">defun</span> <span style="color: #c678dd;">comment-dwim-line</span> (<span style="color: #ECBE7B;">&amp;optional</span> arg)
  <span style="color: #7b8186;">"Replacement for the comment-dwim command.</span>
<span style="color: #7b8186;">   If no region is selected and current line is not blank and we are</span>
<span style="color: #7b8186;">   not at the end of the line, then comment current line.</span>
<span style="color: #7b8186;">   Replaces default behaviour of comment-dwim, when it inserts</span>
<span style="color: #7b8186;">   comment at the end of the line."</span>
  (<span style="color: #51afef;">interactive</span> <span style="color: #98be65;">"*P"</span>)
  (comment-normalize-vars)
  (<span style="color: #51afef;">if</span> (<span style="color: #51afef;">and</span> (not (region-active-p)) (not (looking-at <span style="color: #98be65;">"[ \t]*$"</span>)))
      (comment-or-uncomment-region (line-beginning-position) (line-end-position))
    (comment-dwim arg)))
(<span style="color: #51afef;">bind-key</span> <span style="color: #98be65;">"M-;"</span> 'comment-dwim-line prog-mode-map)
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-5-1-3" class="outline-4">
<h4 id="sec-5-1-3">Heap</h4>
<div class="outline-text-4" id="text-5-1-3">
<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #51afef;">setq-default</span> indent-tabs-mode nil)
(<span style="color: #51afef;">setq</span> global-linum-mode nil)
(<span style="color: #51afef;">setq-default</span> tab-width 4)
(add-hook 'prog-mode-hook (<span style="color: #51afef;">lambda</span> () (hl-line-mode 1)))
(<span style="color: #51afef;">with-eval-after-load</span> 'smartparens
  (add-hook 'prog-mode-hook #'smartparens-mode))
(add-hook 'prog-mode-hook 'global-company-mode)
(add-hook 'prog-mod (<span style="color: #51afef;">lambda</span> () (abbrev-mode nil)))
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-5-2" class="outline-3">
<h3 id="sec-5-2">CC</h3>
<div class="outline-text-3" id="text-5-2">
<div class="org-src-container">

<pre class="src src-emacs-lisp">  (<span style="color: #51afef;">use-package</span> <span style="color: #a9a1e1;">cc-mode</span>
    <span style="color: #c678dd;">:bind</span> (<span style="color: #c678dd;">:map</span>
           c-mode-base-map
           (<span style="color: #98be65;">"C-c b"</span> . compile)))
(<span style="color: #51afef;">defun</span> <span style="color: #c678dd;">astyle-this-buffer</span> (pmin pmax)
  (<span style="color: #51afef;">interactive</span> <span style="color: #98be65;">"r"</span>)
  (shell-command-on-region pmin pmax
                           <span style="color: #98be65;">"astyle"</span> <span style="color: #5B6268;">;; </span><span style="color: #5B6268;">add options here...</span>
                           (current-buffer) t
                           (get-buffer-create <span style="color: #98be65;">"*Astyle Errors*"</span>) t))
(add-hook 'c-mode-common-hook
          (<span style="color: #51afef;">lambda</span> ()
            (<span style="color: #51afef;">require</span> '<span style="color: #a9a1e1;">dtrt-indent</span>)
            (dtrt-indent-mode nil)))
</pre>
</div>
</div>

<div id="outline-container-sec-5-2-1" class="outline-4">
<h4 id="sec-5-2-1">C++</h4>
<div class="outline-text-4" id="text-5-2-1">
<div class="org-src-container">

<pre class="src src-emacs-lisp">(add-hook 'c++-mode-hook (<span style="color: #51afef;">lambda</span> () (<span style="color: #51afef;">setq</span> c-basic-offset 4)))
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-5-3" class="outline-3">
<h3 id="sec-5-3">Python</h3>
<div class="outline-text-3" id="text-5-3">
<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #51afef;">defun</span> <span style="color: #c678dd;">toggle-pdb</span> ()
  (<span style="color: #51afef;">interactive</span>)
  (<span style="color: #51afef;">let</span> ((line (s-trim (thing-at-point 'line t)))
        (debug <span style="color: #98be65;">"import ipdb; ipdb.set_trace()"</span>))
    (<span style="color: #51afef;">cond</span> ((equal line debug)
           (kill-whole-line)
           (previous-line)
           (move-end-of-line 1))
          (t (python-nav-end-of-statement)
             (<span style="color: #51afef;">cond</span> ((equal line <span style="color: #98be65;">""</span>)
                    (insert debug))
                   ((not (equal (length line) 0))
                    (move-end-of-line 1)
                    (newline-and-indent)
                    (insert debug)))))))

(add-hook 'python-mode-hook
          (<span style="color: #51afef;">lambda</span> () (local-set-key (kbd <span style="color: #98be65;">"C-c C-d"</span>) #'toggle-pdb)))

(<span style="color: #51afef;">setq</span> python-shell-interpreter <span style="color: #98be65;">"ipython"</span>
      python-shell-interpreter-args <span style="color: #98be65;">"-i"</span>)

(<span style="color: #51afef;">use-package</span> <span style="color: #a9a1e1;">jedi</span>
  <span style="color: #c678dd;">:bind</span> ((<span style="color: #98be65;">"C-c /"</span> . jedi:show-doc)))<span style="background-color: #3D3D48;"> </span>
(eval-after-load <span style="color: #98be65;">"python-mode"</span>
  '(define-key python-mode-map (kbd <span style="color: #98be65;">"C-c ."</span>) 'jedi:goto-definition))
(<span style="color: #51afef;">defun</span> <span style="color: #c678dd;">jedi-python-mode-hook</span> ()
  (add-to-list 'company-backends 'company-jedi)
  (define-key python-mode-map (kbd <span style="color: #98be65;">"C-c ."</span>) 'jedi:goto-definition))

(add-hook 'python-mode-hook 'jedi-python-mode-hook)
(<span style="color: #51afef;">setq</span> jedi:complete-on-dot t)
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-5-4" class="outline-3">
<h3 id="sec-5-4">Emacs Lisp</h3>
<div class="outline-text-3" id="text-5-4">
<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #51afef;">defun</span> <span style="color: #c678dd;">elisp-keybindings</span> ()
  (local-set-key (kbd <span style="color: #98be65;">"H-e"</span>) #'eval-buffer))
(add-hook 'emacs-lisp-mode-hook 'elisp-keybindings)
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-5-5" class="outline-3">
<h3 id="sec-5-5">Coffeescript</h3>
<div class="outline-text-3" id="text-5-5">
<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #51afef;">setq</span> coffee-tab-width 2)
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-6" class="outline-2">
<h2 id="sec-6">Org</h2>
<div class="outline-text-2" id="text-6">
<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #51afef;">use-package</span> <span style="color: #a9a1e1;">org</span>
  <span style="color: #c678dd;">:diminish</span> s org-indent-mode
  <span style="color: #c678dd;">:config</span>
  (<span style="color: #51afef;">setq</span> org-agenda-files (list <span style="color: #98be65;">"~/Documents/Classes/school-schedule.org"</span>))
  (<span style="color: #51afef;">setq</span> org-bullets-bullet-list (list <span style="color: #98be65;">"&#9679;"</span> <span style="color: #98be65;">"&#9679;"</span> <span style="color: #98be65;">"&#9675;"</span> <span style="color: #98be65;">"&#9675;"</span> <span style="color: #98be65;">"&#9675;"</span> <span style="color: #98be65;">"&#9675;"</span> <span style="color: #98be65;">"&#9675;"</span> <span style="color: #98be65;">"&#9675;"</span> <span style="color: #98be65;">"&#9675;"</span>))
  (<span style="color: #51afef;">setq</span> org-export-backends '(ascii html icalendar latex md))
  (<span style="color: #51afef;">setq</span> org-fontify-whole-heading-line t)
  (<span style="color: #51afef;">setq</span> org-pretty-entities t)
  (<span style="color: #51afef;">setq</span> org-list-allow-alphabetical t)
  (org-babel-do-load-languages
   'org-babel-load-languages
   '((R . t)
     (emacs-lisp . t)
     (python . t)
     (sh . t)))
  (<span style="color: #51afef;">setq</span> org-startup-indented t)
  (<span style="color: #51afef;">setq</span> org-hide-leading-stars t)
  (<span style="color: #51afef;">setq</span> org-src-preserve-indentation nil
        org-edit-src-content-indentation 0)
  (<span style="color: #51afef;">setq</span> org-confirm-babel-evaluate nil
        org-src-fontify-natively t
        org-src-tab-acts-natively t)
  (<span style="color: #51afef;">setq</span> org-startup-folded 'content)
  <span style="color: #5B6268;">;; </span><span style="color: #5B6268;">in org mode C-a/e moves to beginning of text in line, after header asterisks</span>
  <span style="color: #5B6268;">;; </span><span style="color: #5B6268;">however you can press it again to go all the way</span>
  (<span style="color: #51afef;">setq</span> org-special-ctrl-a/e t)
  <span style="color: #5B6268;">;; </span><span style="color: #5B6268;">don't display slashes/asterisks etc for italics/bold etc</span>
  (<span style="color: #51afef;">setq</span> org-hide-emphasis-markers t)
  (<span style="color: #51afef;">setq</span> org-fontify-done-headline t
        org-fontify-quote-and-verse-blocks t)
  (set-face-attribute 'org-level-1 nil <span style="color: #c678dd;">:inherit</span> 'outline-1 <span style="color: #c678dd;">:height</span> 1.25)
  (set-face-attribute 'org-level-2 nil <span style="color: #c678dd;">:inherit</span> 'outline-2 <span style="color: #c678dd;">:height</span> 1.15)
  (add-hook 'org-mode-hook (<span style="color: #51afef;">lambda</span> () (<span style="color: #51afef;">setq</span> line-spacing '0.25)))
  (<span style="color: #51afef;">setq</span> org-use-sub-superscripts <span style="color: #98be65;">"{}"</span>)
  (<span style="color: #51afef;">setq</span> org-export-headline-levels 5)
  (<span style="color: #51afef;">setq</span> org-export-with-section-numbers nil)

  (<span style="color: #51afef;">setq</span> org-src-ask-before-returning-to-edit-buffer nil)
  (<span style="color: #51afef;">setq</span> org-src-window-setup 'current-window)
  (add-to-list 'org-structure-template-alist
               '(<span style="color: #98be65;">"el"</span> <span style="color: #98be65;">"#+BEGIN_SRC emacs-lisp\n?\n#+END_SRC"</span> <span style="color: #98be65;">""</span>))
  (<span style="color: #51afef;">setq</span> org-html-head-extra
        (concat <span style="color: #98be65;">"&lt;link rel=\"stylesheet\" type=\"text/css\" href=\""</span>
<span style="color: #c678dd; background-color: #23272e;">                </span><span style="color: #c678dd; background-color: #23272e;">"raw.githubusercontent.com/spruceb/.emacs.d/master/literate/css/org-export.css"</span>
                <span style="color: #98be65;">"\"&gt;&lt;/link&gt;"</span>))
  (<span style="color: #51afef;">defun</span> <span style="color: #c678dd;">spruce/org-cycle-current-subtree</span> ()
    (<span style="color: #51afef;">interactive</span>)
    (<span style="color: #51afef;">let</span> ((old-tab-style org-cycle-emulate-tab))
      (<span style="color: #51afef;">setq</span> org-cycle-emulate-tab nil)
      (org-cycle)
      (<span style="color: #51afef;">setq</span> org-cycle-emulate-tab old-tab-style)))

  <span style="color: #c678dd;">:bind</span> ((<span style="color: #98be65;">"C-c a a"</span> . org-agenda-list)
         (<span style="color: #98be65;">"C-c L"</span> . org-insert-link-global)
         (<span style="color: #98be65;">"C-c o"</span> . org-open-at-point-global)
         (<span style="color: #98be65;">"H-M-&lt;return&gt;"</span> . org-insert-subheading)
         <span style="color: #c678dd;">:map</span> org-mode-map
         (<span style="color: #98be65;">"C-&lt;tab&gt;"</span> . spruce/org-cycle-current-subtree)))

(<span style="color: #51afef;">use-package</span> <span style="color: #a9a1e1;">org-bullets</span>
  <span style="color: #c678dd;">:config</span>
  (add-hook 'org-mode-hook
            (<span style="color: #51afef;">lambda</span> () (org-bullets-mode 1)))
  (setcdr org-bullets-bullet-map nil))
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-7" class="outline-2">
<h2 id="sec-7">LaTeX</h2>
<div class="outline-text-2" id="text-7">
<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #51afef;">use-package</span> <span style="color: #a9a1e1;">tex</span>
  <span style="color: #c678dd;">:ensure</span> auctex
  <span style="color: #c678dd;">:config</span>
  <span style="color: #5B6268;">;; </span><span style="color: #5B6268;">TODO: fucks up prettify for some reason?</span>
  <span style="color: #5B6268;">;; </span><span style="color: #5B6268;">(company-auctex-init)</span>
  <span style="color: #5B6268;">;; </span><span style="color: #5B6268;">save buffer style info</span>
  (<span style="color: #51afef;">setq</span> TeX-auto-save t)
  <span style="color: #5B6268;">;; </span><span style="color: #5B6268;">automatically parse style info</span>
  (<span style="color: #51afef;">setq</span> TeX-parse-self t)
  <span style="color: #5B6268;">;; </span><span style="color: #5B6268;">no tabs</span>
  (<span style="color: #51afef;">setq</span> TeX-auto-untabify t)
  <span style="color: #5B6268;">;; </span><span style="color: #5B6268;">TODO: unsure what this does</span>
  <span style="color: #5B6268;">;; </span><span style="color: #5B6268;">(setq-default TeX-master 'dwim)</span>
  (<span style="color: #51afef;">setq</span> TeX-PDF-mode t)
  (<span style="color: #51afef;">defun</span> <span style="color: #c678dd;">spruce/TeX-open-output-buffer</span> ()
    (<span style="color: #51afef;">interactive</span>)
    (<span style="color: #51afef;">let</span> ((output-file (<span style="color: #51afef;">with-current-buffer</span> TeX-command-buffer
                         (expand-file-name
                          (TeX-active-master (TeX-output-extension))))))
      (find-file output-file)))
  (add-to-list 'TeX-view-program-list
               (list <span style="color: #98be65;">"Emacs"</span> #'spruce/TeX-open-output-buffer))
  (<span style="color: #51afef;">setq</span> TeX-view-program-selection '((output-pdf <span style="color: #98be65;">"Emacs"</span>)))
  <span style="color: #5B6268;">;; </span><span style="color: #5B6268;">better name for local variable</span>
  (<span style="color: #51afef;">setq</span> TeX-auto-local <span style="color: #98be65;">".auctex-auto"</span>)
  <span style="color: #5B6268;">;; </span><span style="color: #5B6268;">auto revert pdf buffer</span>
  (add-hook 'TeX-after-compilation-finished-functions
            #'TeX-revert-document-buffer)
  <span style="color: #5B6268;">;; </span><span style="color: #5B6268;">show errors if there were any</span>
  (<span style="color: #51afef;">setq</span> TeX-error-overview-open-after-TeX-run t)
  <span style="color: #5B6268;">;; </span><span style="color: #5B6268;">don't confirm before cleaning files</span>
  (<span style="color: #51afef;">setq</span> TeX-clean-confirm nil)
  (<span style="color: #51afef;">setq</span> TeX-save-query nil)
  (<span style="color: #51afef;">defun</span> <span style="color: #c678dd;">TeX-insert-pair</span> (arg open-str close-str)
    <span style="color: #7b8186;">"Like TeX-insert-brackes but for any pair"</span>
    (<span style="color: #51afef;">interactive</span> <span style="color: #98be65;">"P"</span>)
    (<span style="color: #51afef;">if</span> (TeX-active-mark)
        (<span style="color: #51afef;">progn</span>
          (<span style="color: #51afef;">if</span> (&lt; (point) (mark)) (exchange-point-and-mark))
          (insert close-str)
          (<span style="color: #51afef;">save-excursion</span> (goto-char (mark)) (insert open-str)))
      (insert open-str)
      (<span style="color: #51afef;">save-excursion</span>
        (<span style="color: #51afef;">if</span> arg (forward-sexp (prefix-numeric-value arg)))
        (insert close-str))))

  (<span style="color: #51afef;">setq</span> TeX-electric-sub-and-superscript t)

  (<span style="color: #51afef;">use-package</span> <span style="color: #a9a1e1;">latex</span>
    <span style="color: #c678dd;">:ensure</span> nil
    <span style="color: #c678dd;">:config</span>
    (add-hook 'LaTeX-mode-hook 'LaTeX-math-mode)
    (<span style="color: #51afef;">setq</span> LaTeX-math-menu-unicode t)
    (add-hook 'LaTeX-mode-hook (<span style="color: #51afef;">lambda</span> () (latex-electric-env-pair-mode t)))
    (add-hook 'LaTeX-mode-hook
              (<span style="color: #51afef;">lambda</span> () (set-fill-column 90)))
    (add-hook 'LaTeX-mode-hook 'turn-on-auto-fill)
    (add-hook 'LaTeX-mode-hook (<span style="color: #51afef;">lambda</span> () (prettify-symbols-mode)))
    (<span style="color: #51afef;">defun</span> <span style="color: #c678dd;">LaTeX-insert-inline-math</span> (arg)
      (<span style="color: #51afef;">interactive</span> <span style="color: #98be65;">"P"</span>)
      (TeX-insert-pair arg <span style="color: #98be65;">"</span><span style="color: #51afef; font-weight: bold;">\\</span><span style="color: #51afef; font-weight: bold;">(</span><span style="color: #98be65;"> "</span> <span style="color: #98be65;">" </span><span style="color: #51afef; font-weight: bold;">\\</span><span style="color: #51afef; font-weight: bold;">)</span><span style="color: #98be65;">"</span>))
    (<span style="color: #51afef;">defun</span> <span style="color: #c678dd;">LaTeX-insert-display-math</span> (arg)
      (<span style="color: #51afef;">interactive</span> <span style="color: #98be65;">"P"</span>)
      (TeX-insert-pair arg <span style="color: #98be65;">"\\[ "</span> <span style="color: #98be65;">" \\]"</span>))
    (<span style="color: #51afef;">defun</span> <span style="color: #c678dd;">spruce/LaTeX-mode-keybindings</span> ()
      (<span style="color: #51afef;">bind-key</span> <span style="color: #98be65;">"H-C-j"</span> #'LaTeX-insert-inline-math
                (current-local-map))
      (<span style="color: #51afef;">bind-key</span> <span style="color: #98be65;">"H-C-k"</span> #'LaTeX-insert-display-math
                (current-local-map)))
    (add-hook 'LaTeX-mode-hook #'spruce/LaTeX-mode-keybindings)
    (<span style="color: #51afef;">with-eval-after-load</span> 'smartparens
      (add-hook 'TeX-mode-hook #'smartparens-mode))
    (<span style="color: #51afef;">use-package</span> <span style="color: #a9a1e1;">font-latex</span>
      <span style="color: #c678dd;">:ensure</span> nil
      <span style="color: #c678dd;">:config</span>
      (set-face-attribute 'font-latex-sedate-face nil
                          <span style="color: #c678dd;">:inherit</span> 'font-lock-constant-face
                          <span style="color: #c678dd;">:foreground</span> 'unspecified)))

  (put 'TeX-command-extra-options 'safe-local-variable
       (<span style="color: #51afef;">lambda</span> (x) (string-equal x <span style="color: #98be65;">"-shell-escape"</span>))))

(<span style="color: #51afef;">use-package</span> <span style="color: #a9a1e1;">reftex</span>
  <span style="color: #c678dd;">:diminish</span> reftex-mode
  <span style="color: #c678dd;">:config</span>
  (add-hook 'LaTeX-mode-hook 'turn-on-reftex)
  (<span style="color: #51afef;">setq</span> reftex-plug-into-AUCTeX t))

(<span style="color: #51afef;">setq</span> latex-templates-directory <span style="color: #98be65;">"~/.emacs.d/templates/latex-templates/"</span>)
(<span style="color: #51afef;">defun</span> <span style="color: #c678dd;">latex-template</span> ()
  (<span style="color: #51afef;">interactive</span>)
  (<span style="color: #51afef;">let*</span> ((files (file-expand-wildcards (concat latex-templates-directory <span style="color: #98be65;">"*.tex"</span>)))
         (selection (completing-read <span style="color: #98be65;">"LaTeX Template: "</span>
                                     (mapcar #'file-name-base files))))
    (insert-file-contents (concat latex-templates-directory selection <span style="color: #98be65;">".tex"</span>))))
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-8" class="outline-2">
<h2 id="sec-8">The Heap</h2>
<div class="outline-text-2" id="text-8">
<p>
Sometimes I want to test out a tweak or fix an annoyance fast, without putting
in the time to document how or why. This is a bad habit, but sometimes
necessary. The Heap is where all of that temporarily unfiled code goes.
</p>
</div>
<div id="outline-container-sec-8-1" class="outline-3">
<h3 id="sec-8-1">Package Heap</h3>
<div class="outline-text-3" id="text-8-1">
</div><div id="outline-container-sec-8-1-1" class="outline-4">
<h4 id="sec-8-1-1">Tramp</h4>
<div class="outline-text-4" id="text-8-1-1">
<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #51afef;">use-package</span> <span style="color: #a9a1e1;">tramp</span>
  <span style="color: #c678dd;">:config</span>
  (<span style="color: #51afef;">setq</span> tramp-ssh-controlmaster-options
        <span style="color: #98be65;">"-o ControlMaster=auto -o ControlPath='tramp.%%C' -o ControlPersist=yes"</span>)
  (<span style="color: #51afef;">setq</span> tramp-default-method <span style="color: #98be65;">"ssh"</span>))
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-8-1-2" class="outline-4">
<h4 id="sec-8-1-2">recentf</h4>
<div class="outline-text-4" id="text-8-1-2">
<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #51afef;">use-package</span> <span style="color: #a9a1e1;">recentf</span>
  <span style="color: #c678dd;">:config</span>
  (<span style="color: #51afef;">setq</span> recentf-max-menu-items 100)
  (recentf-mode t)
  <span style="color: #c678dd;">:bind</span> (<span style="color: #98be65;">"C-x C-r"</span> . helm-recentf))
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-8-1-3" class="outline-4">
<h4 id="sec-8-1-3">undo-tree</h4>
<div class="outline-text-4" id="text-8-1-3">
<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #51afef;">use-package</span> <span style="color: #a9a1e1;">undo-tree</span>
  <span style="color: #c678dd;">:diminish</span> undo-tree-mode
  <span style="color: #c678dd;">:config</span>
  (<span style="color: #51afef;">setq</span> undo-tree-auto-save-history t)
  (add-to-list 'undo-tree-history-directory-alist
               '(<span style="color: #98be65;">"."</span> . <span style="color: #98be65;">"~/.emacs.d/cache/undo"</span>))
  (global-undo-tree-mode))
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-8-1-4" class="outline-4">
<h4 id="sec-8-1-4">flyspell</h4>
<div class="outline-text-4" id="text-8-1-4">
<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #51afef;">use-package</span> <span style="color: #a9a1e1;">flyspell</span>
  <span style="color: #c678dd;">:config</span>
  (add-hook 'prog-mode-hook #'flyspell-prog-mode)
  (<span style="color: #51afef;">defun</span> <span style="color: #c678dd;">spruce/enable-text-flyspell</span> ()
    (flyspell-mode t))
  (add-hook 'text-mode-hook #'spruce/enable-text-flyspell))
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-8-1-5" class="outline-4">
<h4 id="sec-8-1-5">xscheme</h4>
<div class="outline-text-4" id="text-8-1-5">
<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #51afef;">use-package</span> <span style="color: #a9a1e1;">xscheme</span>)
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-8-1-6" class="outline-4">
<h4 id="sec-8-1-6">magit</h4>
<div class="outline-text-4" id="text-8-1-6">
<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #51afef;">use-package</span> <span style="color: #a9a1e1;">magit</span>
  <span style="color: #c678dd;">:config</span>
  (<span style="color: #51afef;">setq</span> magit-last-seen-setup-instructions <span style="color: #98be65;">"1.4.0"</span>)
  (<span style="color: #51afef;">setq</span> magit-auto-revert-mode t)
  <span style="color: #c678dd;">:bind</span> (<span style="color: #98be65;">"C-c g"</span> . magit-status))
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-8-1-7" class="outline-4">
<h4 id="sec-8-1-7">markdown-mode</h4>
<div class="outline-text-4" id="text-8-1-7">
<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #51afef;">use-package</span> <span style="color: #a9a1e1;">markdown-mode</span>
  <span style="color: #c678dd;">:mode</span> <span style="color: #98be65;">"\\.md\\'"</span>
  <span style="color: #c678dd;">:config</span>
  (add-hook 'markdown-mode-hook 'visual-line-mode))
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-8-1-8" class="outline-4">
<h4 id="sec-8-1-8">smartparens</h4>
<div class="outline-text-4" id="text-8-1-8">
<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #51afef;">use-package</span> <span style="color: #a9a1e1;">smartparens</span>
  <span style="color: #c678dd;">:diminish</span> smartparens-mode
  <span style="color: #c678dd;">:config</span>
  (<span style="color: #51afef;">require</span> '<span style="color: #a9a1e1;">smartparens-config</span>)
  (global-set-key (kbd <span style="color: #98be65;">"C-M-&lt;backspace&gt;"</span>) 'sp-unwrap-sexp)
  (<span style="color: #51afef;">setq</span> sp-navigate-consider-stringlike-sexp
        (append sp-navigate-consider-stringlike-sexp (list 'python-mode
                                                           'org-mode
                                                           'coffeescript-mode)))
  (<span style="color: #51afef;">setq</span> sp-highlight-pair-overlay nil))
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-8-1-9" class="outline-4">
<h4 id="sec-8-1-9">persistent-scratch</h4>
<div class="outline-text-4" id="text-8-1-9">
<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #51afef;">use-package</span> <span style="color: #a9a1e1;">persistent-scratch</span>
  <span style="color: #c678dd;">:config</span> (persistent-scratch-setup-default))
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-8-1-10" class="outline-4">
<h4 id="sec-8-1-10">transpose-frame</h4>
<div class="outline-text-4" id="text-8-1-10">
<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #51afef;">use-package</span> <span style="color: #a9a1e1;">transpose-frame</span>)
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-8-1-11" class="outline-4">
<h4 id="sec-8-1-11">buffer-move</h4>
<div class="outline-text-4" id="text-8-1-11">
<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #51afef;">use-package</span> <span style="color: #a9a1e1;">buffer-move</span>)
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-8-1-12" class="outline-4">
<h4 id="sec-8-1-12">fill-column-indicator</h4>
<div class="outline-text-4" id="text-8-1-12">
<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #51afef;">use-package</span> <span style="color: #a9a1e1;">fill-column-indicator</span>)
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-8-1-13" class="outline-4">
<h4 id="sec-8-1-13"></h4>
</div>
</div>
<div id="outline-container-sec-8-2" class="outline-3">
<h3 id="sec-8-2">Old Heap</h3>
<div class="outline-text-3" id="text-8-2">
<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #51afef;">when</span> (string-equal system-name <span style="color: #98be65;">"Spruces-MacBook-Pro.local"</span>)
  (add-to-list 'load-path <span style="color: #98be65;">"/usr/local/Cellar/zlib/1.2.8/lib/pkgconfig"</span>)
  (add-to-list 'load-path <span style="color: #98be65;">"/usr/local/lib/pkgconfig"</span>)
  (add-to-list 'load-path <span style="color: #98be65;">"/opt/X11/lib/pkgconfig"</span>))

(<span style="color: #51afef;">setq</span> exec-path (append exec-path '(<span style="color: #98be65;">":/usr/local/bin"</span>)))
(setenv <span style="color: #98be65;">"PATH"</span> (concat (getenv <span style="color: #98be65;">"PATH"</span>) <span style="color: #98be65;">":/usr/local/bin"</span>))
(<span style="color: #51afef;">setq</span> exec-path (append exec-path '(<span style="color: #98be65;">":/usr/texbin"</span>)))
(setenv <span style="color: #98be65;">"PATH"</span> (concat (getenv <span style="color: #98be65;">"PATH"</span>) <span style="color: #98be65;">":/usr/texbin"</span>))


<span style="color: #5B6268;">;; </span><span style="color: #5B6268;">(require 'spaceline-config)</span>
<span style="color: #5B6268;">;; </span><span style="color: #5B6268;">(spaceline-emacs-theme)</span>
<span style="color: #5B6268;">;; </span><span style="color: #5B6268;">(spaceline-toggle-buffer-encoding-abbrev-off)</span>
<span style="color: #5B6268;">;; </span><span style="color: #5B6268;">(spaceline-toggle-buffer-size-off)</span>
<span style="color: #5B6268;">;; </span><span style="color: #5B6268;">(spaceline-helm-mode)</span>
<span style="color: #5B6268;">;; </span><span style="color: #5B6268;">(spaceline-toggle-remote-host-off)</span>
<span style="color: #5B6268;">;; </span><span style="color: #5B6268;">(setq powerline-default-separator 'utf8)</span>
<span style="color: #5B6268;">;; </span><span style="color: #5B6268;">(setq spaceline-highlight-face-func 'spaceline-highlight-face-default)</span>
<span style="color: #5B6268;">;; </span><span style="color: #5B6268;">(setq spaceline-highlight-face-func (lambda () ('CadetBlue1)))</span>

<span style="color: #5B6268;">;; </span><span style="color: #5B6268;">(powerline-default-theme)</span>
<span style="color: #5B6268;">;; </span><span style="color: #5B6268;">(setq powerline-default-separator 'utf-8)</span>

(global-set-key (kbd <span style="color: #98be65;">"C-&lt;tab&gt;"</span>) 'company-complete)

(<span style="color: #51afef;">setq</span> dekstop-auto-save-timeout 300)
(fset 'scheme-linebr
      <span style="color: #98be65;">"\273\267\260-"</span>)
<span style="color: #5B6268;">;; </span><span style="color: #5B6268;">(set-mouse-color "green")</span>

(<span style="color: #51afef;">setq</span> doc-view-continuous t)
(<span style="color: #51afef;">setq</span> doc-view-ghostscript-program <span style="color: #98be65;">"/usr/local/bin/gs"</span>)

(load <span style="color: #98be65;">"~/.emacs.d/fireplace/fireplace"</span>)

(<span style="color: #51afef;">setq</span> fi:find-tag-lock nil)

<span style="color: #5B6268;">;; </span><span style="color: #5B6268;">Use Source Code Sans (pretty variable width font) for org mode</span>
<span style="color: #5B6268;">;;; </span><span style="color: #5B6268;">function that sets current buffer to Source Code Sans</span>
<span style="color: #5B6268;">;; </span><span style="color: #5B6268;">(defun my-buffer-face-mode-variable ()</span>
<span style="color: #5B6268;">;;   </span><span style="color: #5B6268;">"Set font to a variable width (proportional) fonts in current buffer"</span>
<span style="color: #5B6268;">;;   </span><span style="color: #5B6268;">(interactive)</span>
<span style="color: #c678dd; background-color: #23272e;">;;   </span><span style="color: #c678dd; background-color: #23272e;">(setq buffer-face-mode-face '(:family "Source Code Sans" :height 100 :width semi-condensed))</span>
<span style="color: #5B6268;">;;   </span><span style="color: #5B6268;">(buffer-face-mode))</span>

(projectile-global-mode)

(<span style="color: #51afef;">if</span> (eq system-type 'darwin)
    (<span style="color: #51afef;">setq</span> helm-locate-fuzzy-match nil))

(<span style="color: #51afef;">setq</span> helm-locate-command
      (<span style="color: #51afef;">case</span> system-type
        ('gnu/linux <span style="color: #98be65;">"locate -i -r %s"</span>)
        ('berkeley-unix <span style="color: #98be65;">"locate -i %s"</span>)
        ('windows-nt <span style="color: #98be65;">"es %s"</span>)
        ('darwin <span style="color: #98be65;">"mdfind -name %s %s | grep -v .*.emlx"</span>)
        (t <span style="color: #98be65;">"locate %s"</span>)))

(<span style="color: #51afef;">if</span> (display-graphic-p)
    (desktop-save-mode nil))
(<span style="color: #51afef;">setq</span> desktop-dirname <span style="color: #98be65;">"~/.emacs.d/desktops/"</span>
      desktop-path (<span style="color: #51afef;">quote</span> (<span style="color: #98be65;">"~/.emacs.d/desktops/"</span>))
      desktop-auto-save-timeout 30
      desktop-save nil)

(add-to-list 'auto-mode-alist '(<span style="color: #98be65;">"\\.h\\'"</span> . c++-mode))
(add-hook 'coffeescript-mode-hook 'whitespace-mode)
(add-hook 'python-mode-hook 'whitespace-mode)
(<span style="color: #51afef;">setq</span> whitespace-style
      '(face trailing space-before-tab tab
             indentation empty space-after-tab lines))
<span style="color: #5B6268;">;; </span><span style="color: #5B6268;">don't do anything whitespace, use whitespace-fn instead</span>
(<span style="color: #51afef;">setq</span> whitespace-action nil)

(<span style="color: #51afef;">defun</span> <span style="color: #c678dd;">init-projectile</span> ()
  (<span style="color: #51afef;">interactive</span>)
  (<span style="color: #51afef;">let</span> ((projectile <span style="color: #98be65;">".projectile"</span>))
    (<span style="color: #51afef;">unless</span> (file-exists-p projectile)
      (write-region <span style="color: #98be65;">""</span> nil projectile))))
(global-aggressive-indent-mode 1)

(<span style="color: #51afef;">require</span> '<span style="color: #a9a1e1;">highlight-indent-guides</span>)
<span style="color: #5B6268;">;; </span><span style="color: #5B6268;">(add-hook 'prog-mode-hook 'highlight-indent-guides-mode)</span>
(<span style="color: #51afef;">setq</span> highlight-indent-guides-method 'character)

(<span style="color: #51afef;">defun</span> <span style="color: #c678dd;">whitespace-save-fn</span> ()
  (add-hook 'before-save-hook
            'delete-trailing-whitespace-except-current-line
            nil 'local))

(add-hook 'c-mode-common-hook #'whitespace-save-fn)
(add-hook 'python-mode-hook #'whitespace-save-fn)
(add-hook 'lisp-mode-hook #'whitespace-save-fn)
(add-hook 'prog-mode-hook #'whitespace-mode)
(add-hook 'prog-mode-hook (<span style="color: #51afef;">lambda</span> () (hl-line-mode 1)))
<span style="color: #5B6268;">;; </span><span style="color: #5B6268;">(setq auto-revert-use-notify nil)</span>

(<span style="color: #51afef;">setq</span> whitespace-line-column 86)
(<span style="color: #51afef;">setq</span> hl-line-sticky-flag nil)

<span style="color: #5B6268;">;; </span><span style="color: #5B6268;">latex</span>
(<span style="color: #51afef;">defun</span> <span style="color: #c678dd;">tex-runall-clean</span> ()
  (<span style="color: #51afef;">interactive</span>)
  (TeX-command-run-all nil)
  (TeX-clean))

(<span style="color: #51afef;">setq</span> debug-on-error nil)
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-sec-9" class="outline-2">
<h2 id="sec-9">Utility Functions</h2>
<div class="outline-text-2" id="text-9">
<p>
These functions are bound to keys and used in various places in my config.
Functions are only here if I felt they were sufficiently general, not tied to a
specific setting. Documentation is generally provided in the docstring rather
than through <code>org</code>. This code block is not tangled, rather it is included through
<code>noweb</code> near the top of this file.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #5B6268;">;; </span><span style="color: #5B6268;">see http://ergoemacs.org/emacs/modernization_elisp_lib_problem.html</span>
(<span style="color: #51afef;">defun</span> <span style="color: #c678dd;">s-trim-left</span> (s)
  <span style="color: #7b8186;">"Remove whitespace at the beginning of S."</span>
  (<span style="color: #51afef;">if</span> (string-match <span style="color: #98be65;">"\\`[ \t\n\r]+"</span> s)
      (replace-match <span style="color: #98be65;">""</span> t t s)
    s))

(<span style="color: #51afef;">defun</span> <span style="color: #c678dd;">s-trim-right</span> (s)
  <span style="color: #7b8186;">"Remove whitespace at the end of S."</span>
  (<span style="color: #51afef;">if</span> (string-match <span style="color: #98be65;">"[ \t\n\r]+\\'"</span> s)
      (replace-match <span style="color: #98be65;">""</span> t t s)
    s))

(<span style="color: #51afef;">defun</span> <span style="color: #c678dd;">s-trim</span> (s)
  <span style="color: #7b8186;">"Remove whitespace at the beginning and end of S."</span>
  (s-trim-left (s-trim-right s)))

(<span style="color: #51afef;">defun</span> <span style="color: #c678dd;">delete-trailing-whitespace-except-current-line</span> ()
  (<span style="color: #51afef;">interactive</span>)
  (<span style="color: #51afef;">let</span> ((begin (line-beginning-position))
        (end (line-end-position)))
    (<span style="color: #51afef;">save-excursion</span>
      (<span style="color: #51afef;">when</span> (&lt; (point-min) begin)
        (<span style="color: #51afef;">save-restriction</span>
          (narrow-to-region (point-min) (1- begin))
          (delete-trailing-whitespace)))
      (<span style="color: #51afef;">when</span> (&gt; (point-max) end)
        (<span style="color: #51afef;">save-restriction</span>
          (narrow-to-region (1+ end) (point-max))
          (delete-trailing-whitespace))))))

<span style="color: #5B6268;">;; </span><span style="color: #5B6268;">from http://stackoverflow.com/questions/15580913/</span>
(<span style="color: #51afef;">defun</span> <span style="color: #c678dd;">toggle-quotes</span> ()
  (<span style="color: #51afef;">interactive</span>)
  (<span style="color: #51afef;">save-excursion</span>
    (<span style="color: #51afef;">let</span> ((start (nth 8 (syntax-ppss)))
          (quote-length 0) sub kind replacement)
      (goto-char start)
      (<span style="color: #51afef;">setq</span> sub (buffer-substring start (<span style="color: #51afef;">progn</span> (forward-sexp) (point)))
            kind (aref sub 0))
      (<span style="color: #51afef;">while</span> (char-equal kind (aref sub 0))
        (<span style="color: #51afef;">setq</span> sub (substring sub 1)
              quote-length (1+ quote-length)))
      (<span style="color: #51afef;">setq</span> sub (substring sub 0 (- (length sub) quote-length)))
      (goto-char start)
      (delete-region start (+ start (* 2 quote-length) (length sub)))
      (<span style="color: #51afef;">setq</span> kind (<span style="color: #51afef;">if</span> (char-equal kind ?\") ?\' ?\"))
      (<span style="color: #51afef;">loop</span> for i from 0
            for c across sub
            for slash = (char-equal c ?\\)
            then (<span style="color: #51afef;">if</span> (<span style="color: #51afef;">and</span> (not slash) (char-equal c ?\\)) t nil) do
            (<span style="color: #51afef;">unless</span> slash
              (<span style="color: #51afef;">when</span> (member c '(?\" ?\'))
                (aset sub i
                      (<span style="color: #51afef;">if</span> (char-equal kind ?\") ?\' ?\")))))
      (<span style="color: #51afef;">setq</span> replacement (make-string quote-length kind))
      (insert replacement sub replacement))))

(<span style="color: #51afef;">defun</span> <span style="color: #c678dd;">move-line-up</span> ()
  <span style="color: #7b8186;">"Move up the current line."</span>
  (<span style="color: #51afef;">interactive</span>)
  (transpose-lines 1)
  (forward-line -2)
  (indent-according-to-mode))

(<span style="color: #51afef;">defun</span> <span style="color: #c678dd;">move-line-down</span> ()
  <span style="color: #7b8186;">"Move down the current line."</span>
  (<span style="color: #51afef;">interactive</span>)
  (forward-line 1)
  (transpose-lines 1)
  (forward-line -1)
  (indent-according-to-mode))

(<span style="color: #51afef;">defun</span> <span style="color: #c678dd;">revert-buffer-no-prompt</span> ()
  <span style="color: #7b8186;">"Revert buffer without confirm prompt"</span>
  (<span style="color: #51afef;">interactive</span>)
  (revert-buffer t t))

(<span style="color: #51afef;">defun</span> <span style="color: #c678dd;">backward-kill-line</span> (arg)5
  <span style="color: #98be65;">"Kill ARG lines backward."</span>
  (<span style="color: #51afef;">interactive</span> <span style="color: #98be65;">"p"</span>)
  (kill-line (- 1 arg)))
</pre>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: Spruce Bondera</p>
<p class="date">Created: 2016-10-23 Sun 18:01</p>
<p class="creator"><a href="http://www.gnu.org/software/emacs/">Emacs</a> 25.1.1 (<a href="http://orgmode.org">Org</a> mode 8.2.10)</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
